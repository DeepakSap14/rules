<div class="dt-global-header">

    <!-- global filter -->
    <!-- issue https://github.com/angular/angular/issues/6179  have to use hidden. -->
    <!-- *ngIf doesn't work with template variables -->
    <div [hidden]="!hasGlobalFilter">
        <input #globalF type="text" pInputText size="50" placeholder="Global Filter">
        <i class="fa fa-search" style="margin:4px 4px 0 0"></i>
    </div>

    <!-- table customization. User can customize which columns are displayed. -->
    <!--  !!!!!! NOT IMPLEMENTED. -->
    <i *ngIf="isTableCustomizable" class="ariba-icon icon-table-customization"></i>

    <!-- table configuration. pin columns, expand, collapse rows, # of rows to display-->
    <!-- !!!!! NOT IMPLEMENTED -->
    <i *ngIf="isTableConfigurable" class="sap-icon icon-action-settings"></i>

</div>

<!-- Our datatable -->
<p-dataTable #dataTable
             [paginator]="paginator" [rows]="rows" [totalRecords]="totalRecords"
             [pageLinks]="pageLinks" [responsive]="responsive" [stacked]="stacked"
             [selectionMode]="selectionMode" [(selection)]="selectedRows"
             [editable]="editable"
             [filterDelay]="filterDelay" [lazy]="lazy" [resizableColumns]="resizableColumns"
             [columnResizeMode]="columnResizeMode" [scrollable]="scrollable"
             [virtualScroll]="virtualScroll" [scrollHeight]="scrollHeight"
             [scrollWidth]="scrollWidth" [frozenWidth]="frozenWidth"
             [unfrozenWidth]="unfrozenWidth" [style]="style" [styleClass]="styleClass"
             [tableStyle]="tableStyle" [tableStyleClass]="tableStyleClass"
             [globalFilter]="globalF" [sortMode]="sortMode" [sortField]="sortField"
             [sortOrder]="sortOrder" [groupField]="groupField" [multiSortMeta]="multiSortMeta"
             [contextMenu]="contextMenu" [paginatorPosition]="paginatorPosition"
             [metaKeySelection]="metaKeySelection" [expandableRows]="expandableRows"
             [expandedRows]="expandedRows" [expandableRowGroups]="expandableRowGroups"
             [tabindex]="tabindex" [rowStyleClass]="rowStyleClass" [rowGroupMode]="rowGroupMode"
             [sortableRowGroup]="sortableRowGroup" [sortFile]="sortFile" [rowHover]="rowHover"
             [first]="first" [filters]="filters" [dataKey]="dataKey" [loading]="loading"
             [value]="list"
             (onLazyLoad)="onLazyLoad($event)"
             (onRowSelect)="onRowSelect($event)"
             (onRowUnselect)="onRowUnselect($event)">

    <p-header>
        <ng-content select="aw-dt-header"></ng-content>
    </p-header>

    <!-- single select, add column for the radio button -->
    <p-column *ngIf="selectionMode == 'single'" [styleClass]="'dt-selection-column u-no-border-r'"
              selectionMode="single">
    </p-column>

    <!-- multi-select, add column for checkbox. -->
    <p-column *ngIf="selectionMode == 'multiple'"
              [styleClass]="'dt-selection-column u-no-border-r'"
              selectionMode="multiple"></p-column>

    <ng-container *ngFor="let col of cols">

        <p-column *ngIf="!col.hasTemplates()"
                  [field]="col.field"
                  [sortField]="col.sortField"
                  [header]="col.header"
                  [footer]="col.footer"
                  [sortable]="col.sortable"
                  [editable]="col.editable"
                  [filter]="col.filter"
                  [filterMatchMode]="col.filterMatchMode"
                  [filterType]="col.filterType"
                  [rowspan]="col.rowspan"
                  [colspan]="col.colspan"
                  [style]="col.style"
                  [styleClass]="col.styleClass"
                  [hidden]="col.hidden"
                  [expander]="col.expander"
                  [filterPlaceholder]="col.filterPlaceholder"
                  [frozen]="col.frozen"
                  [selectionMode]="col.multiselect">
        </p-column>

        <!-- Column with template should have their template projected inside p-column -->
        <p-column #column *ngIf="col.hasTemplates()"
                  [field]="col.field"
                  [sortField]="col.sortField"
                  [header]="col.header"
                  [footer]="col.footer"
                  [sortable]="col.sortable"
                  [editable]="col.editable"
                  [filter]="col.filter"
                  [filterMatchMode]="col.filterMatchMode"
                  [filterType]="col.filterType"
                  [rowspan]="col.rowspan"
                  [colspan]="col.colspan"
                  [style]="col.style"
                  [styleClass]="col.styleClass"
                  [hidden]="col.hidden"
                  [expander]="col.expander"
                  [filterPlaceholder]="col.filterPlaceholder"
                  [frozen]="col.frozen">
            <ng-container *ngFor="let temp of col.templates">

                <ng-template let-col let-rowData="rowData" let-rowIndex="rowIndex"
                             [pTemplate]="temp.name">
                    <ng-template *ngIf="true" [ngTemplateOutlet]="temp.template"
                                 [ngTemplateOutletContext]="{$implicit: col,rowData: rowData, rowIndex: rowIndex}">

                    </ng-template>
                </ng-template>

            </ng-container>
        </p-column>

    </ng-container>

    <p-footer *ngIf="hasFooter()">
        <ng-content select="aw-dt-footer"></ng-content>
    </p-footer>
</p-dataTable>
